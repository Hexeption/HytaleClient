name: Windows Build

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build:
    name: Build on Windows
    runs-on: windows-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Configure CMake (Visual Studio)
        shell: pwsh
        run: |
          cmake -S . -B build -G "Visual Studio 17 2022" -A x64 -DCMAKE_BUILD_TYPE=Release

      - name: Build (Release)
        shell: pwsh
        run: |
          cmake --build build --config Release --target Client Injector -- /m

      - name: List build outputs
        shell: pwsh
        run: |
          Write-Host "Contents of build directory:";
          Get-ChildItem -Path build -Recurse | Select-Object FullName,Length | Format-Table -AutoSize

